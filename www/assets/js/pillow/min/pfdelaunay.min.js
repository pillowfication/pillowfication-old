(function(e){"use strict";e.delaunay=function(e){function N(t,i){var s=_(n[t],n[i]);if(s.length!=2)return;var o=r[s[0]],u=r[s[1]],a=C(u,t,i),f=e[o[0]],l=e[o[1]],c=e[o[2]],h=e[a],p=h.x*h.x+h.y*h.y,d=f.x-h.x,v=f.y-h.y,m=f.x*f.x+f.y*f.y-p,g=l.x-h.x,y=l.y-h.y,b=l.x*l.x+l.y*l.y-p,w=c.x-h.x,E=c.y-h.y,S=c.x*c.x+c.y*c.y-p;if(d*y*S+v*b*w+m*g*E-d*b*E-v*g*S-m*y*w>0){var x=C(o,t,i);n[t].splice(O(n[t],s[1]),1),n[i].splice(O(n[i],s[0]),1),n[a].splice(O(n[a],s[0]),0,s[0]),n[x].splice(O(n[x],s[1]),0,s[1]),o.splice(M(o,i),1,a),u.splice(M(u,t),1,x),N(t,x),N(t,a),N(i,x),N(i,a)}}function C(e,t,n){return e[0]!=t&&e[0]!=n?e[0]:e[1]!=t&&e[1]!=n?e[1]:e[2]}function k(e,t,i){var s=r.length;n[e].push(s),n[t].push(s),n[i].push(s),r.push([e,t,i])}function L(t,n,r){return(e[n].x-e[t].x)*(e[r].y-e[t].y)-(e[n].y-e[t].y)*(e[r].x-e[t].x)}function A(t,n,r){var i=e[t].x-e[n].x,s=e[t].y-e[n].y,o=e[r].x-e[n].x,u=e[r].y-e[n].y;return-Math.atan2(i*u-s*o,i*o+s*u)}function O(e,t){var n=-1,r=e.length,i;while(r>n+1)i=r+n+1>>1,e[i]<=t?n=i:r=i;return n!=-1&&e[n]==t?n:n+1}function M(e,t){return e[0]==t?0:e[1]==t?1:2}function _(e,t){var n=0,r=0,i=[];while(n<e.length&&r<t.length)e[n]<t[r]?++n:t[r]<e[n]?++r:(i.push(e[n]),++n,++r);return i}var t=[],n=[],r=[],i=e.length;for(var s=0;s<i;++s)t.push(s);t.sort(function(t,n){return e[t].y==e[n].y?e[t].x-e[n].x:e[t].y-e[n].y});var o,u,a=Math.PI*3/4,f=t[0],l=t[1],c=[f,l],h,p;for(h=2;h<i;++h){if((p=L(f,l,t[h]))!=0)break;c.push(t[h])}l=t[h-1];var d=e[f],v=e[l],m=t[h],g=e[m];d.x<v.x&&d.x<g.x?p>0?v.x<=g.x?(o=[f,m],u=c.concat(m)):(o=[f,m,l],u=c):(o=c.concat(m),u=[f,m]):d.x>v.x&&d.x>g.x?(p*=-1)>0?v.x>=g.x?(o=[m,f],u=[m].concat(c.reverse())):(o=[l,m,f],u=c.reverse()):(o=[m].concat(c.reverse()),u=[m,f]):v.x<g.x?(o=[l,m],u=c.reverse().concat(m),p*=-1):(o=[m,l],u=[m].concat(c)),n[f]=[0],n[l]=[h-2],n[m]=[0];if(p>0){for(var s=1;s<h-1;++s)n[c[s]]=[s-1,s],n[m].push(s),r.push([m,c[s-1],c[s]]);r.push([m,c[h-2],c[h-1]])}else{for(var s=1;s<h-1;++s)n[c[s]]=[s-1,s],n[m].push(s),r.push([m,c[s],c[s-1]]);r.push([m,c[h-1],c[h-2]])}for(var y=h+1;y<i;++y){var s=t[y],b=e[s];n[s]=[];var w=-1,E=o.length,S;while(E-w>1)S=E+w+1>>1,e[o[S]].x<=b.x?w=S:E=S;if(w==-1){L(s,o[0],o[1])>0?(k(s,o[0],o[1]),N(o[0],o[1]),o.splice(0,1,s)):o.unshift(s),u.unshift(s);for(var x=1;x<u.length-1;++x){if(!(L(s,u[x],u[x+1])<0))break;k(s,u[x+1],u[x]),N(s,u[x]),N(s,u[x+1]),u.splice(x,1)}}else if(w==o.length-1){L(s,o[w],o[w-1])<0?(k(s,o[w-1],o[w]),N(o[w-1],o[w]),o.splice(w,1,s)):o.push(s),u.push(s);for(var x=u.length-2;x>0;--x){if(!(L(s,u[x],u[x-1])>0))break;k(s,u[x],u[x-1]),N(s,u[x]),N(s,u[x-1]),u.splice(x++,1)}}else k(s,o[w],o[w+1]),N(o[w],o[w+1]),o.splice(w+1,0,s);for(var x=w+2;x>0&&x<o.length-1;++x){var T=A(o[x-1],o[x],o[x+1]);if(!(T>0&&T<a))break;k(o[x-1],o[x],o[x+1]),N(o[x-1],o[x]),N(o[x],o[x+1]),o.splice(x--,1)}for(var x=w;x>0&&x<o.length-1;--x){var T=A(o[x-1],o[x],o[x+1]);if(!(T>0&&T<a))break;k(o[x-1],o[x],o[x+1]),N(o[x-1],o[x]),N(o[x],o[x+1]),o.splice(x,1)}}for(var s=0;s<o.length-1;++s){if(s==0||L(o[s-1],o[s],o[s+1])<=0)continue;k(o[s-1],o[s],o[s+1]),N(o[s-1],o[s]),N(o[s],o[s+1]),o.splice(s,1),s-=2}return u.pop(),o.reverse(),{triangles:r,data:n,hull:u.concat(o)}}})(window.Pillow=window.Pillow||{});